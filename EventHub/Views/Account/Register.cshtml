@model EventHub.Models.ViewModels.RegisterViewModel
@{
    ViewData["Title"] = "Join EventHub - Create Your Account";
}

@section Styles {
    <!-- Import the register.css file -->
    <link rel="stylesheet" href="~/css/register.css" asp-append-version="true" />
}

<!-- Registration Hero Section -->
<section class="registration-hero">
    <div class="container">
        <div class="row align-items-center min-vh-80">
            <div class="col-lg-6">
                <div class="hero-content">
                    <h1 class="hero-title">Join the <span class="gradient-text">EventHub</span> Community</h1>
                    <p class="hero-subtitle">
                        Create your account and start discovering amazing events, or organize
                        your own and reach thousands of potential attendees.
                    </p>

                    <!-- Role Selection -->
                    <div class="role-selector mb-4">
                        <h5 class="role-title">Choose Your Role:</h5>
                        <div class="role-options">
                            <div class="role-option active" data-role="customer" onclick="selectRole('customer')">
                                <div class="role-icon">
                                    <i class="bi bi-person-heart"></i>
                                </div>
                                <div class="role-info">
                                    <h6>Event Goer</h6>
                                    <p>Discover and book amazing events</p>
                                </div>
                            </div>
                            <div class="role-option" data-role="organizer" onclick="selectRole('organizer')">
                                <div class="role-icon">
                                    <i class="bi bi-megaphone"></i>
                                </div>
                                <div class="role-info">
                                    <h6>Event Organizer</h6>
                                    <p>Create and manage your events</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Benefits List -->
                    <div class="benefits-list" id="benefitsList">
                        <!-- Benefits will be populated based on selected role -->
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="registration-form-container">
                    <!-- Registration Form -->
                    <div class="registration-form-card">
                        <div class="form-header">
                            <h3 class="form-title">Create Your Account</h3>
                            <p class="form-subtitle">Join thousands of event enthusiasts</p>
                        </div>

                        <form asp-action="Register" method="post" class="auth-form" id="registrationForm">
                            @Html.AntiForgeryToken()

                            <!-- Step Indicator -->
                            <div class="step-indicator">
                                <div class="step active" data-step="1">
                                    <span class="step-number">1</span>
                                    <span class="step-label">Basic Info</span>
                                </div>
                                <div class="step" data-step="2">
                                    <span class="step-number">2</span>
                                    <span class="step-label">Profile</span>
                                </div>
                                <div class="step" data-step="3">
                                    <span class="step-number">3</span>
                                    <span class="step-label">Verify</span>
                                </div>
                            </div>

                            <!-- Validation Summary -->
                            <div asp-validation-summary="All" class="validation-summary-errors"></div>

                            <!-- Step 1: Basic Information -->
                            <div class="form-step active" data-step="1">
                                <h5 class="step-title">
                                    <i class="bi bi-person-fill me-2"></i>Basic Information
                                </h5>

                                <div class="row g-3">
                                    <!-- Full Name - Keep compatible with existing backend -->
                                    <div class="col-12">
                                        <label asp-for="Name" class="form-label required">Full Name</label>
                                        <input asp-for="Name" type="text" class="form-control form-input" id="name" required>
                                        <span asp-validation-for="Name" class="field-validation-error"></span>
                                    </div>

                                    <!-- Email -->
                                    <div class="col-12">
                                        <label asp-for="Email" class="form-label required">Email Address</label>
                                        <input asp-for="Email" type="email" class="form-control form-input" id="email" required>
                                        <span asp-validation-for="Email" class="field-validation-error"></span>
                                        <div class="form-text">We'll never share your email with anyone else.</div>
                                    </div>

                                    <!-- Phone -->
                                    <div class="col-12">
                                        <label asp-for="Phone" class="form-label">Phone Number</label>
                                        <input asp-for="Phone" type="tel" class="form-control form-input" id="phone"
                                               placeholder="+94 XX XXX XXXX">
                                        <span asp-validation-for="Phone" class="field-validation-error"></span>
                                    </div>

                                    <!-- Password -->
                                    <div class="col-12">
                                        <label asp-for="Password" class="form-label required">Password</label>
                                        <div class="input-group">
                                            <input asp-for="Password" type="password" class="form-control " id="password" required>
                                            <button type="button" class="btn btn-outline-secondary password-toggle" tabindex="-1">
                                                <i class="bi bi-eye"></i>
                                            </button>
                                        </div>
                                        <span asp-validation-for="Password" class="field-validation-error"></span>
                                        <div class="password-strength" style="display: none;">
                                            <small class="text-muted">Password strength indicator</small>
                                        </div>
                                    </div>

                                    <!-- Confirm Password -->
                                    <div class="col-12">
                                        <label asp-for="ConfirmPassword" class="form-label required">Confirm Password</label>
                                        <div class="input-group">
                                            <input asp-for="ConfirmPassword" type="password" class="form-control " id="confirmPassword" required>
                                            <button type="button" class="btn btn-outline-secondary password-toggle" tabindex="-1">
                                                <i class="bi bi-eye"></i>
                                            </button>
                                        </div>
                                        <span asp-validation-for="ConfirmPassword" class="field-validation-error"></span>
                                    </div>
                                </div>
                            </div>

                            <!-- Step 2: Profile Information -->
                            <div class="form-step" data-step="2">
                                <h5 class="step-title">
                                    <i class="bi bi-person-badge me-2"></i>Profile Details
                                </h5>

                                <!-- Role Selection (Hidden input for backend compatibility) -->
                                <input asp-for="Role" type="hidden" name="Role" id="roleField" value="1" />

                                <!-- Additional Profile Fields -->
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label class="form-label">Date of Birth</label>
                                        <input type="date" class="form-control form-input" id="dateOfBirth" name="DateOfBirth">
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Gender</label>
                                        <select class="form-select form-input" id="gender" name="Gender">
                                            <option value="">Select gender</option>
                                            <option value="Male">Male</option>
                                            <option value="Female">Female</option>
                                            <option value="Other">Other</option>
                                            <option value="PreferNotToSay">Prefer not to say</option>
                                        </select>
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label">City</label>
                                        <select class="form-select form-input" id="city" name="City">
                                            <option value="">Select your city</option>
                                            <option value="Colombo">Colombo</option>
                                            <option value="Kandy">Kandy</option>
                                            <option value="Galle">Galle</option>
                                            <option value="Negombo">Negombo</option>
                                            <option value="Jaffna">Jaffna</option>
                                            <option value="Kurunegala">Kurunegala</option>
                                            <option value="Anuradhapura">Anuradhapura</option>
                                            <option value="Batticaloa">Batticaloa</option>
                                            <option value="Other">Other</option>
                                        </select>
                                    </div>

                                    <!-- Customer Specific Fields -->
                                    <div class="customer-fields">
                                        <div class="col-12">
                                            <label class="form-label">Event Interests (Optional)</label>
                                            <input type="hidden" id="interestsField" name="Interests" />
                                            <div class="interest-checkboxes">
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input interest-checkbox" type="checkbox"
                                                           id="interest-music" value="Music">
                                                    <label class="form-check-label" for="interest-music">
                                                        <i class="bi bi-music-note me-1"></i>Music
                                                    </label>
                                                </div>
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input interest-checkbox" type="checkbox"
                                                           id="interest-sports" value="Sports">
                                                    <label class="form-check-label" for="interest-sports">
                                                        <i class="bi bi-trophy me-1"></i>Sports
                                                    </label>
                                                </div>
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input interest-checkbox" type="checkbox"
                                                           id="interest-arts" value="Arts">
                                                    <label class="form-check-label" for="interest-arts">
                                                        <i class="bi bi-palette me-1"></i>Arts
                                                    </label>
                                                </div>
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input interest-checkbox" type="checkbox"
                                                           id="interest-business" value="Business">
                                                    <label class="form-check-label" for="interest-business">
                                                        <i class="bi bi-briefcase me-1"></i>Business
                                                    </label>
                                                </div>
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input interest-checkbox" type="checkbox"
                                                           id="interest-food" value="Food">
                                                    <label class="form-check-label" for="interest-food">
                                                        <i class="bi bi-cup-hot me-1"></i>Food
                                                    </label>
                                                </div>
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input interest-checkbox" type="checkbox"
                                                           id="interest-technology" value="Technology">
                                                    <label class="form-check-label" for="interest-technology">
                                                        <i class="bi bi-laptop me-1"></i>Tech
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Organizer Specific Fields -->
                                    <div class="organizer-fields company-field" style="display: none;">
                                        <div class="col-12">
                                            <label asp-for="Company" class="form-label required">Company/Organization Name</label>
                                            <input asp-for="Company" type="text" class="form-control form-input" id="company">
                                            <span asp-validation-for="Company" class="field-validation-error"></span>
                                        </div>
                                        <div class="col-12">
                                            <label class="form-label">Website (Optional)</label>
                                            <input type="url" class="form-control form-input" id="website" name="Website"
                                                   placeholder="https://example.com">
                                        </div>
                                        <div class="col-12">
                                            <label class="form-label">Organization Type</label>
                                            <select class="form-select form-input" id="organizationType" name="OrganizationType">
                                                <option value="">Select organization type</option>
                                                <option value="Individual">Individual Organizer</option>
                                                <option value="Company">Company</option>
                                                <option value="NonProfit">Non-profit Organization</option>
                                                <option value="Government">Government Agency</option>
                                                <option value="Educational">Educational Institution</option>
                                                <option value="Other">Other</option>
                                            </select>
                                        </div>
                                        <div class="col-12">
                                            <label class="form-label">Organization Description</label>
                                            <textarea class="form-control form-input" id="description" name="Description" rows="3"
                                                      placeholder="Brief description of your organization and event goals..."></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Step 3: Verification -->
                            <div class="form-step" data-step="3">
                                <h5 class="step-title">
                                    <i class="bi bi-shield-check me-2"></i>Verification & Preferences
                                </h5>

                                <div class="verification-content">
                                    <!-- Email Verification -->
                                    <div class="verification-item">
                                        <div class="verification-icon">
                                            <i class="bi bi-envelope-check"></i>
                                        </div>
                                        <div class="verification-details">
                                            <h6>Email Verification</h6>
                                            <p>We'll send a verification link to <strong id="verificationEmail"></strong></p>
                                        </div>
                                    </div>

                                    <!-- Preferences -->
                                    <div class="preferences-section mt-4">
                                        <h6>Communication Preferences</h6>
                                        <div class="preference-options">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" name="EmailNotifications" id="emailNotifications" checked>
                                                <label class="form-check-label" for="emailNotifications">
                                                    <strong>Email Notifications</strong><br>
                                                    <small class="text-muted">Event updates, booking confirmations, and newsletters</small>
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" name="SmsNotifications" id="smsNotifications">
                                                <label class="form-check-label" for="smsNotifications">
                                                    <strong>SMS Notifications</strong><br>
                                                    <small class="text-muted">Important updates and event reminders</small>
                                                </label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" name="MarketingEmails" id="marketingEmails" checked>
                                                <label class="form-check-label" for="marketingEmails">
                                                    <strong>Marketing Communications</strong><br>
                                                    <small class="text-muted">Special offers, new features, and event recommendations</small>
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Terms and Conditions -->
                                    <div class="terms-section mt-4">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="terms" required>
                                            <label class="form-check-label" for="terms">
                                                I agree to the <a href="#" onclick="showTerms()">Terms of Service</a> and
                                                <a href="#" onclick="showPrivacyPolicy()">Privacy Policy</a> *
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="ageConfirmation" required>
                                            <label class="form-check-label" for="ageConfirmation">
                                                I confirm that I am at least 13 years old *
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Navigation Buttons -->
                            <div class="form-navigation">
                                <button type="button" class="btn btn-secondary" id="prevBtn"
                                        onclick="previousStep()" style="display: none;">
                                    <i class="bi bi-arrow-left me-2"></i>Previous
                                </button>
                                <button type="button" class="btn btn-primary" id="nextBtn" onclick="nextStep()">
                                    Next<i class="bi bi-arrow-right ms-2"></i>
                                </button>
                                <button type="submit" class="btn btn-success" id="submitBtn" style="display: none;">
                                    <i class="bi bi-check-circle me-2"></i>Create Account
                                </button>
                            </div>
                        </form>

                        <!-- Login Link -->
                        <div class="login-link">
                            <p>Already have an account? <a asp-action="Login">Sign in here</a></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script src="~/js/auth.js" asp-append-version="true"></script>
    <script src="~/js/register-enhanced.js" asp-append-version="true"></script>
}