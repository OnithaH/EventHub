<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - EventHub</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/eventhub.css" asp-append-version="true" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
</head>
<body>
    <!-- Modern Navbar -->
    <nav class="navbar navbar-expand-lg navbar-modern fixed-top" id="mainNavbar">
        <div class="container">
            <!-- Brand Logo -->
            <a class="navbar-brand navbar-brand-modern" asp-area="" asp-controller="Home" asp-action="Index">
                <i class="bi bi-calendar-event me-2"></i>EventHub
            </a>

            <!-- Mobile Toggle Button -->
            <button class="navbar-toggler navbar-toggler-modern" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false"
                    aria-label="Toggle navigation">
                <i class="bi bi-list"></i>
            </button>

            <!-- Navigation Menu -->
            <div class="collapse navbar-collapse" id="navbarNav">
                <!-- Main Navigation Links -->
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link nav-link-modern" asp-area="" asp-controller="Home" asp-action="Index">
                            <i class="bi bi-house me-1"></i>Home
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link nav-link-modern" asp-area="" asp-controller="Event" asp-action="Index">
                            <i class="bi bi-calendar3 me-1"></i>Events
                        </a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link nav-link-modern dropdown-toggle" href="#" id="categoriesDropdown"
                           role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="bi bi-grid-3x3-gap me-1"></i>Categories
                        </a>
                        <ul class="dropdown-menu dropdown-menu-modern" aria-labelledby="categoriesDropdown">
                            <li><a class="dropdown-item dropdown-item-modern" href="@Url.Action("Index", "Event", new { category = "Music" })">🎵 Music</a></li>
                            <li><a class="dropdown-item dropdown-item-modern" href="@Url.Action("Index", "Event", new { category = "Sports" })">⚽ Sports</a></li>
                            <li><a class="dropdown-item dropdown-item-modern" href="@Url.Action("Index", "Event", new { category = "Theatre" })">🎭 Theatre</a></li>
                            <li><a class="dropdown-item dropdown-item-modern" href="@Url.Action("Index", "Event", new { category = "Cultural" })">🎨 Cultural</a></li>
                            <li><a class="dropdown-item dropdown-item-modern" href="@Url.Action("Index", "Event", new { category = "Technology" })">💻 Technology</a></li>
                        </ul>
                    </li>
                    @if (User.IsInRole("Organizer"))
                    {
                        <li class="nav-item">
                            <a class="nav-link nav-link-modern" asp-area="" asp-controller="Organizer" asp-action="Dashboard">
                                <i class="bi bi-speedometer2 me-1"></i>Dashboard
                            </a>
                        </li>
                    }
                    @if (User.IsInRole("Admin"))
                    {
                        <li class="nav-item">
                            <a class="nav-link nav-link-modern" asp-area="" asp-controller="Admin" asp-action="Dashboard">
                                <i class="bi bi-gear me-1"></i>Admin
                            </a>
                        </li>
                    }
                </ul>

                <!-- User Authentication Section -->
                <ul class="navbar-nav ms-auto">
                    @if (User.Identity.IsAuthenticated)
                    {
                        <!-- Authenticated User Menu -->
                        @if (User.IsInRole("Customer"))
                        {
                            <li class="nav-item me-2">
                                <a class="nav-link nav-link-modern position-relative" asp-controller="Booking" asp-action="MyBookings">
                                    <i class="bi bi-ticket-perforated me-1"></i>My Tickets
                                </a>
                            </li>
                        }

                        <li class="nav-item dropdown">
                            <a class="nav-link nav-link-modern dropdown-toggle d-flex align-items-center" href="#"
                               id="userDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                <div class="user-avatar">
                                    @User.Identity.Name?.Substring(0, 1).ToUpper()
                                </div>
                                @User.Identity.Name
                            </a>
                            <ul class="dropdown-menu dropdown-menu-modern dropdown-menu-end" aria-labelledby="userDropdown">
                                <li>
                                    <a class="dropdown-item dropdown-item-modern" asp-controller="Profile" asp-action="Index">
                                        <i class="bi bi-person me-2"></i>Profile
                                    </a>
                                </li>
                                @if (User.IsInRole("Customer"))
                                {
                                    <li>
                                        <a class="dropdown-item dropdown-item-modern" asp-controller="Booking" asp-action="MyBookings">
                                            <i class="bi bi-ticket me-2"></i>My Bookings
                                        </a>
                                    </li>
                                }
                                @if (User.IsInRole("Organizer"))
                                {
                                    <li>
                                        <a class="dropdown-item dropdown-item-modern" asp-controller="Organizer" asp-action="MyEvents">
                                            <i class="bi bi-calendar-plus me-2"></i>My Events
                                        </a>
                                    </li>
                                    <li>
                                        <a class="dropdown-item dropdown-item-modern" asp-controller="Organizer" asp-action="Reports">
                                            <i class="bi bi-graph-up me-2"></i>Reports
                                        </a>
                                    </li>
                                }
                                <li><hr class="dropdown-divider"></li>
                                <li>
                                    <a class="dropdown-item dropdown-item-modern" asp-controller="Account" asp-action="Settings">
                                        <i class="bi bi-gear me-2"></i>Settings
                                    </a>
                                </li>
                                <li>
                                    <a class="dropdown-item dropdown-item-modern" asp-controller="Account" asp-action="Logout">
                                        <i class="bi bi-box-arrow-right me-2"></i>Logout
                                    </a>
                                </li>
                            </ul>
                        </li>
                    }
                    else
                    {
                        <!-- Guest User Buttons -->
                        <li class="nav-item me-2">
                            <a class="btn btn-auth btn-login" asp-controller="Account" asp-action="Login">
                                <i class="bi bi-box-arrow-in-right me-1"></i>Login
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="btn btn-auth btn-signup" asp-controller="Account" asp-action="Register">
                                <i class="bi bi-person-plus me-1"></i>Sign Up
                            </a>
                        </li>
                    }
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content with padding for fixed navbar -->
    <main role="main" class="flex-fill" style="padding-top: 80px;">
        @RenderBody()
    </main>

    <!-- Modern Footer -->
    <footer class="footer-modern">
        <div class="container">
            <div class="row">
                <!-- Company Info -->
                <div class="col-lg-4 col-md-6 mb-4">
                    <h5 class="fw-bold mb-3">
                        <i class="bi bi-calendar-event me-2"></i>EventHub
                    </h5>
                    <p class="mb-3">Your trusted platform for discovering and booking amazing events. From concerts to conferences, we bring you closer to the experiences you love.</p>
                    <div class="d-flex flex-wrap">
                        <a href="#" class="social-icon">
                            <i class="bi bi-facebook"></i>
                        </a>
                        <a href="#" class="social-icon">
                            <i class="bi bi-twitter-x"></i>
                        </a>
                        <a href="#" class="social-icon">
                            <i class="bi bi-instagram"></i>
                        </a>
                        <a href="#" class="social-icon">
                            <i class="bi bi-linkedin"></i>
                        </a>
                        <a href="#" class="social-icon">
                            <i class="bi bi-youtube"></i>
                        </a>
                    </div>
                </div>

                <!-- Quick Links -->
                <div class="col-lg-2 col-md-6 mb-4">
                    <h6 class="fw-bold mb-3">Quick Links</h6>
                    <ul class="list-unstyled">
                        <li>
                            <a href="@Url.Action("Index", "Home")" class="footer-link">
                                <i class="bi bi-chevron-right me-1"></i>Home
                            </a>
                        </li>
                        <li>
                            <a href="@Url.Action("Index", "Event")" class="footer-link">
                                <i class="bi bi-chevron-right me-1"></i>Browse Events
                            </a>
                        </li>
                        <li>
                            <a href="@Url.Action("About", "Home")" class="footer-link">
                                <i class="bi bi-chevron-right me-1"></i>About Us
                            </a>
                        </li>
                        <li>
                            <a href="@Url.Action("Contact", "Home")" class="footer-link">
                                <i class="bi bi-chevron-right me-1"></i>Contact
                            </a>
                        </li>
                    </ul>
                </div>

                <!-- Categories -->
                <div class="col-lg-2 col-md-6 mb-4">
                    <h6 class="fw-bold mb-3">Categories</h6>
                    <ul class="list-unstyled">
                        <li>
                            <a href="@Url.Action("Index", "Event", new { category = "Music" })" class="footer-link">
                                <i class="bi bi-music-note me-1"></i>Music
                            </a>
                        </li>
                        <li>
                            <a href="@Url.Action("Index", "Event", new { category = "Sports" })" class="footer-link">
                                <i class="bi bi-trophy me-1"></i>Sports
                            </a>
                        </li>
                        <li>
                            <a href="@Url.Action("Index", "Event", new { category = "Theatre" })" class="footer-link">
                                <i class="bi bi-mask me-1"></i>Theatre
                            </a>
                        </li>
                        <li>
                            <a href="@Url.Action("Index", "Event", new { category = "Cultural" })" class="footer-link">
                                <i class="bi bi-palette me-1"></i>Cultural
                            </a>
                        </li>
                    </ul>
                </div>

                <!-- For Organizers -->
                <div class="col-lg-2 col-md-6 mb-4">
                    <h6 class="fw-bold mb-3">For Organizers</h6>
                    <ul class="list-unstyled">
                        <li>
                            <a href="@Url.Action("Register", "Account", new { role = "organizer" })" class="footer-link">
                                <i class="bi bi-plus-circle me-1"></i>Create Events
                            </a>
                        </li>
                        <li>
                            <a href="@Url.Action("Pricing", "Home")" class="footer-link">
                                <i class="bi bi-currency-dollar me-1"></i>Pricing
                            </a>
                        </li>
                        <li>
                            <a href="@Url.Action("Features", "Home")" class="footer-link">
                                <i class="bi bi-star me-1"></i>Features
                            </a>
                        </li>
                        <li>
                            <a href="@Url.Action("Support", "Home")" class="footer-link">
                                <i class="bi bi-headset me-1"></i>Support
                            </a>
                        </li>
                    </ul>
                </div>

                <!-- Support -->
                <div class="col-lg-2 col-md-6 mb-4">
                    <h6 class="fw-bold mb-3">Support</h6>
                    <ul class="list-unstyled">
                        <li>
                            <a href="@Url.Action("Help", "Home")" class="footer-link">
                                <i class="bi bi-question-circle me-1"></i>Help Center
                            </a>
                        </li>
                        <li>
                            <a href="@Url.Action("Privacy", "Home")" class="footer-link">
                                <i class="bi bi-shield-check me-1"></i>Privacy Policy
                            </a>
                        </li>
                        <li>
                            <a href="@Url.Action("Terms", "Home")" class="footer-link">
                                <i class="bi bi-file-text me-1"></i>Terms of Service
                            </a>
                        </li>
                        <li>
                            <a href="@Url.Action("FAQ", "Home")" class="footer-link">
                                <i class="bi bi-chat-dots me-1"></i>FAQ
                            </a>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- Footer Bottom -->
            <div class="footer-bottom">
                <div class="row align-items-center">
                    <div class="col-md-6">
                        <p>&copy; @DateTime.Now.Year EventHub. All rights reserved.</p>
                    </div>
                    <div class="col-md-6 text-md-end">
                        <p>Made with <i class="bi bi-heart-fill text-danger"></i> in Sri Lanka</p>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>

    <script>
        // Navbar scroll effect
        window.addEventListener('scroll', function() {
            const navbar = document.getElementById('mainNavbar');
            if (window.scrollY > 50) {
                navbar.classList.add('navbar-scrolled');
            } else {
                navbar.classList.remove('navbar-scrolled');
            }
        });

        // Active nav link highlighting
        document.addEventListener('DOMContentLoaded', function() {
            const currentLocation = location.pathname;
            const navLinks = document.querySelectorAll('.nav-link-modern');

            navLinks.forEach(link => {
                if (link.getAttribute('href') === currentLocation) {
                    link.classList.add('active');
                } else {
                    link.classList.remove('active');
                }
            });
        });

        // Mobile menu close on link click
        document.addEventListener('DOMContentLoaded', function() {
            const navLinks = document.querySelectorAll('.navbar-nav .nav-link');
            const navbarCollapse = document.querySelector('.navbar-collapse');

            navLinks.forEach(link => {
                link.addEventListener('click', function() {
                    if (window.innerWidth < 992) { // Bootstrap lg breakpoint
                        const bsCollapse = new bootstrap.Collapse(navbarCollapse, {
                            toggle: false
                        });
                        bsCollapse.hide();
                    }
                });
            });
        });

        // Add loading states to navigation links
        document.querySelectorAll('.nav-link, .btn-auth').forEach(link => {
            link.addEventListener('click', function(e) {
                // Only add loading state for navigation links, not dropdowns
                if (!this.classList.contains('dropdown-toggle') && !this.getAttribute('href').startsWith('#')) {
                    const originalText = this.innerHTML;
                    this.innerHTML = '<i class="bi bi-hourglass-split me-1"></i>Loading...';
                    this.style.pointerEvents = 'none';

                    // Reset after 5 seconds (failsafe)
                    setTimeout(() => {
                        this.innerHTML = originalText;
                        this.style.pointerEvents = 'auto';
                    }, 5000);
                }
            });
        });
    </script>

    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>